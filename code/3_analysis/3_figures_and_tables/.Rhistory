return_df=T, plot=F, only_slope = T, line_zero=F, add_confint = T)
})
all_diagREDMDL_betas <- lapply(all_diagREDMDL_betas, function(i) cbind(i, numerator_LogR = gsub("/.*", "", i$LogR)))
all_diagREDMDL_betas_softmax <- lapply(all_diagREDMDL_betas,
function(i) cbind.data.frame(Estimate=softmax(c(i$Estimate[i$type_beta == 'Slope'], 0)),
sig=c(i$numerator_LogR[i$type_beta == 'Slope'],
strsplit(i$LogR[1], '/')[[1]][2])))
names_sigs_unique <- gtools::mixedsort(unique(do.call('rbind', all_diagREDMDL_betas_softmax)$sig))
all_diagREDMDL_betas_softmax_1_5_40 <- t(sapply(all_diagREDMDL_betas_softmax, function(i) i[match(names_sigs_unique, i$sig,),'Estimate']))
colnames(all_diagREDMDL_betas_softmax_1_5_40) <- paste0('SBS', names_sigs_unique)
all_diagREDMDL_betas_softmax_1_5_40 <- data.frame(all_diagREDMDL_betas_softmax_1_5_40, ct=enough_samples)
give_scatter_two_betas <- function(sig1, sig2){
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
geom_smooth(method = "lm", size=0.2)+
ggpubr::stat_cor(method = "pearson", label.x = 0, label.y = 0.38, vjust=1, hjust=-.02, size=3.5, label.sep='\n')+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
do.call('grid.arrange', c(list(
give_scatter_two_betas('SBS1', 'SBS5'),
give_scatter_two_betas('SBS5', 'SBS40'),
give_scatter_two_betas('SBS2', 'SBS13'),
give_scatter_two_betas('SBS2', 'SBS8'),
give_scatter_two_betas('SBS2', 'SBS18'),
give_scatter_two_betas('SBS3', 'SBS18')), nrow=2))
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
geom_smooth(method = "lm", size=0.2)+
ggpubr::stat_cor(method = "MSE", label.x = 0, label.y = 0.38, vjust=1, hjust=-.02, size=3.5, label.sep='\n')+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
give_scatter_two_betas_MSE <- function(sig1, sig2){
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
geom_smooth(method = "lm", size=0.2)+
ggpubr::stat_cor(method = "MSE", label.x = 0, label.y = 0.38, vjust=1, hjust=-.02, size=3.5, label.sep='\n')+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
do.call('grid.arrange', c(list(
give_scatter_two_betas('SBS1', 'SBS5'),
give_scatter_two_betas('SBS5', 'SBS40'),
give_scatter_two_betas('SBS2', 'SBS13'),
give_scatter_two_betas('SBS2', 'SBS8'),
give_scatter_two_betas('SBS2', 'SBS18'),
give_scatter_two_betas('SBS3', 'SBS18')), nrow=2))
pcawg_palette
all_diagREDMDL_betas_softmax_1_5_40
pcawg_palette
enough_samples
cbind(names(pcawg_palette), enough_samples)
stopinot(length(names(pcawg_palette)) == length(enough_samples))
stopifnot(length(names(pcawg_palette)) == length(enough_samples))
names(pcawg_palette) <- enough_samples
give_scatter_two_betas <- function(sig1, sig2){
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
geom_smooth(method = "lm", size=0.2)+
ggpubr::stat_cor(method = "pearson", label.x = 0, label.y = 0.38, vjust=1, hjust=-.02, size=3.5, label.sep='\n')+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
give_scatter_two_betas_MSE <- function(sig1, sig2){
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
geom_smooth(method = "lm", size=0.2)+
ggpubr::stat_cor(method = "MSE", label.x = 0, label.y = 0.38, vjust=1, hjust=-.02, size=3.5, label.sep='\n')+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
do.call('grid.arrange', c(list(
give_scatter_two_betas('SBS1', 'SBS5'),
give_scatter_two_betas('SBS5', 'SBS40'),
give_scatter_two_betas('SBS2', 'SBS13'),
give_scatter_two_betas('SBS2', 'SBS8'),
give_scatter_two_betas('SBS2', 'SBS18'),
give_scatter_two_betas('SBS3', 'SBS18')), nrow=2))
give_scatter_two_betas_MSE('SBS1', 'SBS5')
give_scatter_two_betas_MSE <- function(sig1, sig2){
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
ggpubr::stat_cor(method = "MSE", label.x = 0, label.y = 0.38, vjust=1, hjust=-.02, size=3.5, label.sep='\n')+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
give_scatter_two_betas_MSE('SBS1', 'SBS5')
give_scatter_two_betas('SBS1', 'SBS5')
all_diagREDMDL_betas_softmax_1_5_40
all_diagREDMDL_betas_softmax_1_5_40[,1]
sig1=1
sig2=1
all_diagREDMDL_betas_softmax_1_5_40[,sig1]-all_diagREDMDL_betas_softmax_1_5_40[,sig2]
(all_diagREDMDL_betas_softmax_1_5_40[,sig1]-all_diagREDMDL_betas_softmax_1_5_40[,sig2])**2
mean((all_diagREDMDL_betas_softmax_1_5_40[,sig1]-all_diagREDMDL_betas_softmax_1_5_40[,sig2])**2)
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[,sig1]-all_diagREDMDL_betas_softmax_1_5_40[,sig2])**2)
give_scatter_two_betas_MSE <- function(sig1, sig2){
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[,sig1]-all_diagREDMDL_betas_softmax_1_5_40[,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
geom_label(aes(x = 0, y = 0.38, label = paste0("MSE=", ggplot)), vjust=1, hjust=-.02, size=3.5, label.sep='\n')+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
give_scatter_two_betas_MSE('SBS1', 'SBS5')
give_scatter_two_betas_MSE <- function(sig1, sig2){
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[,sig1]-all_diagREDMDL_betas_softmax_1_5_40[,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
geom_label(aes(x = 0, y = 0.38, label = paste0("MSE=", ggplot)), vjust=1, hjust=-.02, size=3.5)+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
give_scatter_two_betas_MSE('SBS1', 'SBS5')
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
geom_label(aes(x = 0, y = 0.38, label = paste0("MSE=", ggplot)), vjust=1, hjust=-.02, size=3.5)+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
geom_label(aes(x = 0, y = 0.38, label = paste0("MSE=", ggplot)))
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
geom_label(x = 0, y = 0.38, label = paste0("MSE=", ggplot))
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
geom_text(aes(x = 0, y = 0.38, label = paste0("MSE=", ggplot)), vjust=1, hjust=-.02, size=3.5)+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
?geom_text
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text", x = 0, y = 0.38, label = paste0("MSE=", ggplot), vjust=1, hjust=-.02, size=3.5)+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
paste0("MSE=", ggplot)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text", x = 0, y = 0.38, label = paste0("MSE=", mse), vjust=1, hjust=-.02, size=3.5)+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text", x = 0, y = 0.38, label = paste0("MSE=", mse), size=3.5)+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text", x = -Inf, y = Inf, label = paste0("MSE=", mse), size=3.5)+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()
give_scatter_two_betas_MSE <- function(sig1, sig2){
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[,sig1]-all_diagREDMDL_betas_softmax_1_5_40[,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text", x = -Inf, y = Inf, label = paste0("MSE=", mse), size=3.5)+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
give_scatter_two_betas_MSE('SBS1', 'SBS5')
give_scatter_two_betas_MSE <- function(sig1, sig2){
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[,sig1]-all_diagREDMDL_betas_softmax_1_5_40[,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text", x = -Inf, y = max(y), label = paste0("MSE=", mse), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
give_scatter_two_betas_MSE('SBS1', 'SBS5')
give_scatter_two_betas_MSE <- function(sig1, sig2){
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[,sig1]-all_diagREDMDL_betas_softmax_1_5_40[,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text", x = -Inf, y = max(all_diagREDMDL_betas_softmax_1_5_40[,sig2]), label = paste0("MSE=", mse), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
give_scatter_two_betas_MSE('SBS1', 'SBS5')
give_scatter_two_betas_MSE <- function(sig1, sig2){
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[,sig1]-all_diagREDMDL_betas_softmax_1_5_40[,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text", x = -Inf,
x = min(all_diagREDMDL_betas_softmax_1_5_40[,sig1]),
y = max(all_diagREDMDL_betas_softmax_1_5_40[,sig2]),
label = paste0("MSE=", mse), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
give_scatter_two_betas_MSE('SBS1', 'SBS5')
give_scatter_two_betas_MSE <- function(sig1, sig2){
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[,sig1]-all_diagREDMDL_betas_softmax_1_5_40[,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text",
x = min(all_diagREDMDL_betas_softmax_1_5_40[,sig1]),
y = max(all_diagREDMDL_betas_softmax_1_5_40[,sig2]),
label = paste0("MSE=", mse), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
give_scatter_two_betas_MSE('SBS1', 'SBS5')
give_scatter_two_betas_MSE <- function(sig1, sig2){
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[,sig1]-all_diagREDMDL_betas_softmax_1_5_40[,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text",
x = min(all_diagREDMDL_betas_softmax_1_5_40[,sig1])+0.1,
y = max(all_diagREDMDL_betas_softmax_1_5_40[,sig2]),
label = paste0("MSE=", mse), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
give_scatter_two_betas_MSE('SBS1', 'SBS5')
give_scatter_two_betas_MSE <- function(sig1, sig2){
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[,sig1]-all_diagREDMDL_betas_softmax_1_5_40[,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text",
x = min(all_diagREDMDL_betas_softmax_1_5_40[,sig1])+0.1,
y = max(all_diagREDMDL_betas_softmax_1_5_40[,sig2]),
label = paste0("MSE=", signif(mse, 3)), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
give_scatter_two_betas_MSE('SBS1', 'SBS5')
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
warnings()
give_scatter_two_betas_MSE('SBS5', 'SBS40')
give_scatter_two_betas_MSE('SBS1', 'SBS5')
give_scatter_two_betas_MSE('SBS1', 'SBS40')
all_diagREDMDL_betas_softmax_1_5_40
dim(all_diagREDMDL_betas_softmax_1_5_40)
give_scatter_two_betas_MSE <- function(sig1, sig2){
subsetct = !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig1])) & !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig2]))
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig1]-all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text",
x = min(all_diagREDMDL_betas_softmax_1_5_40[,sig1])+0.1,
y = max(all_diagREDMDL_betas_softmax_1_5_40[,sig2]),
label = paste0("MSE=", signif(mse, 3)), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
give_scatter_two_betas_MSE('SBS5', 'SBS40')
sig1='SBS5'
sig2='SBS40'
subsetct = !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig1])) & !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig2]))
subsetct
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig1]-all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig2])**2)
mse
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text",
x = min(all_diagREDMDL_betas_softmax_1_5_40[,sig1])+0.1,
y = max(all_diagREDMDL_betas_softmax_1_5_40[,sig2]),
label = paste0("MSE=", signif(mse, 3)), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
min(all_diagREDMDL_betas_softmax_1_5_40[,sig1])+0.1
max(all_diagREDMDL_betas_softmax_1_5_40[,sig2]
)
give_scatter_two_betas_MSE <- function(sig1, sig2){
subsetct = !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig1])) & !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig2]))
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig1]-all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text",
x = min(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)+0.1,
y = max(all_diagREDMDL_betas_softmax_1_5_40[,sig2], na.rm = T),
label = paste0("MSE=", signif(mse, 3)), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
?rsq
give_scatter_two_betas_MSE <- function(sig1, sig2){
subsetct = !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig1])) & !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig2]))
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig1]-all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text",
x = min(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)+0.1*(max(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)-min(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)),
y = max(all_diagREDMDL_betas_softmax_1_5_40[,sig2], na.rm = T),
label = paste0("MSE=", signif(mse, 3)), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
give_scatter_two_betas_MSE <- function(sig1, sig2){
subsetct = !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig1])) & !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig2]))
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig1]-all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text",
x = min(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)+0.3*(max(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)-min(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)),
y = max(all_diagREDMDL_betas_softmax_1_5_40[,sig2], na.rm = T),
label = paste0("MSE=", signif(mse, 3)), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
dev.off()
tikzDevice::tikz("../../../results/figures_paper/betas_nucleotides_slopes_softmax_scatterplots.tex")
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
dev.off()
tikzDevice::tikz("../../../results/figures_paper/betas_MSE_scatter.tex")
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
dev.off()
dev.off()
tikzDevice::tikz("../../../results/figures_paper/betas_MSE_scatter.tex")
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
dev.off()
tikzDevice::tikz("../../../results/figures_paper/betas_MSE_scatter.tex", height = 3)
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
dev.off()
tikzDevice::tikz("../../../results/figures_paper/betas_MSE_scatter.tex", height = 6)
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
dev.off()
tikzDevice::tikz("../../../results/figures_paper/betas_MSE_scatter.tex", height = 5.5)
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
dev.off()
give_scatter_two_betas_MSE <- function(sig1, sig2){
subsetct = !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig1])) & !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig2]))
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig1]-all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text",
x = min(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)+0.3*(max(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)-min(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)),
y = max(all_diagREDMDL_betas_softmax_1_5_40[,sig2], na.rm = T)-0.3*(max(all_diagREDMDL_betas_softmax_1_5_40[,sig2], na.rm = T)-min(all_diagREDMDL_betas_softmax_1_5_40[,sig2], na.rm = T)),
label = paste0("MSE=", signif(mse, 3)), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
tikzDevice::tikz("../../../results/figures_paper/betas_MSE_scatter.tex", height = 5.5)
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
dev.off()
give_scatter_two_betas_MSE <- function(sig1, sig2){
subsetct = !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig1])) & !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig2]))
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig1]-all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text",
x = min(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)+0.3*(max(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)-min(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)),
y = max(all_diagREDMDL_betas_softmax_1_5_40[,sig2], na.rm = T)-0.15*(max(all_diagREDMDL_betas_softmax_1_5_40[,sig2], na.rm = T)-min(all_diagREDMDL_betas_softmax_1_5_40[,sig2], na.rm = T)),
label = paste0("MSE=", signif(mse, 3)), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
tikzDevice::tikz("../../../results/figures_paper/betas_MSE_scatter.tex", height = 5)
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
dev.off()
give_scatter_two_betas_MSE <- function(sig1, sig2){
subsetct = !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig1])) & !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig2]))
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig1]-all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40, aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text",
x = min(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)+0.3*(max(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)-min(all_diagREDMDL_betas_softmax_1_5_40[,sig1], na.rm = T)),
y = max(all_diagREDMDL_betas_softmax_1_5_40[,sig2], na.rm = T)-0.15*(max(all_diagREDMDL_betas_softmax_1_5_40[,sig2], na.rm = T)-min(all_diagREDMDL_betas_softmax_1_5_40[,sig2], na.rm = T)),
label = paste0("MSE=", signif(mse, 2)), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
tikzDevice::tikz("../../../results/figures_paper/betas_MSE_scatter.tex", height = 5)
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
dev.off()
give_scatter_two_betas_MSE('SBS3', 'SBS18')
all_diagREDMDL_betas_softmax_1_5_40
subsetct
give_scatter_two_betas_MSE <- function(sig1, sig2){
subsetct = !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig1])) & !(is.na(all_diagREDMDL_betas_softmax_1_5_40[,sig2]))
mse <- mean((all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig1]-all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig2])**2)
ggplot(all_diagREDMDL_betas_softmax_1_5_40[subsetct,], aes_string(x=sig1, y=sig2, col='ct', group=1))+
geom_abline(slope = 1, intercept = 0, lty='dashed')+  geom_point(color='black', size=2)+ geom_point()+
theme_bw()+ scale_color_manual(values = pcawg_palette)+theme(legend.position = "bottom")+
# geom_smooth(method = "lm", size=0.2)+
annotate("text",
x = min(all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig1], na.rm = T)+0.3*(max(all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig1], na.rm = T)-min(all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig1], na.rm = T)),
y = max(all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig2], na.rm = T)-0.15*(max(all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig2], na.rm = T)-min(all_diagREDMDL_betas_softmax_1_5_40[subsetct,sig2], na.rm = T)),
label = paste0("MSE=", signif(mse, 2)), size=3.5, )+
labs(x=paste0('Beta slope of ', sig1), y=paste0('Beta slope of ', sig2))+guides(col='none')
}
give_scatter_two_betas_MSE('SBS3', 'SBS18')
dev.off()
tikzDevice::tikz("../../../results/figures_paper/betas_MSE_scatter.tex", height = 5)
do.call('grid.arrange', c(list(
give_scatter_two_betas_MSE('SBS1', 'SBS5'),
give_scatter_two_betas_MSE('SBS5', 'SBS40'),
give_scatter_two_betas_MSE('SBS2', 'SBS13'),
give_scatter_two_betas_MSE('SBS2', 'SBS8'),
give_scatter_two_betas_MSE('SBS2', 'SBS18'),
give_scatter_two_betas_MSE('SBS3', 'SBS18')), nrow=2))
dev.off()
