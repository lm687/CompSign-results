guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
annotate("text", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline")+
annotate("text", x = 14, y = -0.4, label="Lower increase in\nabundance than baseline")
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
annotate("text", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline")+
annotate("text", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
annotate("text", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline")+
annotate("text", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")+
geom_segment(aes(x = 5, y = 30, xend = 3.5, yend = 25),
arrow = arrow(length = unit(0.5, "cm")))
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
annotate("text", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline")+
annotate("text", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")+
geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
arrow = arrow(length = unit(0.5, "cm")))
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
annotate("text", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline")+
annotate("text", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")+
geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
arrow = arrow(length = unit(0.5, "cm")), col='black')
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
arrow = arrow(length = unit(0.5, "cm")), col='black')+
annotate("text", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline")+
annotate("text", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
arrow = arrow(length = unit(0.5, "cm")), col='black')+
annotate("text", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline", fill='white')+
annotate("text", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
arrow = arrow(length = unit(0.5, "cm")), col='black')+
annotate("label", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline", fill='white')+
annotate("text", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
arrow = arrow(length = unit(0.5, "cm")), col='black')+
annotate("label", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline", fill='white')+
annotate("label", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
arrow = arrow(length = unit(0.5, "cm")), col='black')+
geom_segment(aes(x = 15, y = -Inf, xend = 15, yend = 0),
arrow = arrow(length = unit(0.5, "cm")), col='black')+
annotate("label", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline", fill='white')+
annotate("label", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
arrow = arrow(length = unit(0.5, "cm")), col='black')+
geom_segment(aes(x = 15, y = 0, xend = 15, yend = -Inf),
arrow = arrow(length = unit(0.5, "cm")), col='black')+
annotate("label", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline", fill='white')+
annotate("label", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
arrow = arrow(length = unit(0.5, "cm")), col='black')+
geom_segment(aes(x = 20, y = 0, xend = 20, yend = -Inf),
arrow = arrow(length = unit(0.5, "cm")), col='black')+
annotate("label", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline", fill='white')+
annotate("label", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
arrow = arrow(length = unit(0.5, "cm")), col='black')+
geom_segment(aes(x = 21, y = 0, xend = 21, yend = -Inf),
arrow = arrow(length = unit(0.5, "cm")), col='black')+
annotate("label", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline", fill='white')+
annotate("label", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
geom_segment(aes(x = 2, y = 0, xend = 2, yend = Inf),
arrow = arrow(length = unit(0.5, "cm")), col='black')+
geom_segment(aes(x = 22, y = 0, xend = 22, yend = -Inf),
arrow = arrow(length = unit(0.5, "cm")), col='black')+
annotate("label", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline", fill='white')+
annotate("label", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
geom_segment(aes(x = 2, y = 0, xend = 2, yend = Inf),
arrow = arrow(length = unit(0.2, "cm")), col='black')+
geom_segment(aes(x = 22, y = 0, xend = 22, yend = -Inf),
arrow = arrow(length = unit(0.2, "cm")), col='black')+
annotate("label", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline", fill='white')+
annotate("label", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")
tikzDevice::tikz("../../results/results_TMB/pcawg/reports_per_cancer_type/cors_trinucleotide3sorted_v3.tex", height = 4, width = 5.5)
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
arrow = arrow(length = unit(0.2, "cm")), col='black')+
geom_segment(aes(x = 19, y = 0, xend = 18, yend = -Inf),
arrow = arrow(length = unit(0.2, "cm")), col='black')+
annotate("label", x = 6, y = 0.4, label="Higher increase in\nabundance than baseline", fill='white')+
annotate("label", x = 18, y = -0.4, label="Lower increase in\nabundance than baseline")
dev.off()
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
# geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
# geom_segment(aes(x = 19, y = 0, xend = 18, yend = -Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
annotate("label", x = 18, y = 0.4, label="Higher increase in\nabundance than baseline", fill='white')+
annotate("label", x = 3, y = -0.4, label="Lower increase in\nabundance than baseline")
tikzDevice::tikz("../../results/results_TMB/pcawg/reports_per_cancer_type/cors_trinucleotide3sorted_v3.tex", height = 4, width = 5.5)
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
# geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
# geom_segment(aes(x = 19, y = 0, xend = 18, yend = -Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
annotate("label", x = 18, y = 0.4, label="Higher increase in\nabundance than baseline", fill='white')+
annotate("label", x = 3, y = -0.4, label="Lower increase in\nabundance than baseline")
dev.off()
dev.off()
tikzDevice::tikz("../../results/results_TMB/pcawg/reports_per_cancer_type/cors_trinucleotide3sorted_v3.tex", height = 4, width = 5.5)
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
# geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
# geom_segment(aes(x = 19, y = 0, xend = 18, yend = -Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
annotate("label", x = 18, y = 0.4, label="Higher increase in\nabundance than baseline", fill='white')+
annotate("label", x = 3, y = -0.4, label="Lower increase in\nabundance than baseline")
dev.off()
tikzDevice::tikz("../../results/results_TMB/pcawg/reports_per_cancer_type/cors_trinucleotide3sorted_v3.tex", height = 4, width = 5.5)
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
# geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
# geom_segment(aes(x = 19, y = 0, xend = 18, yend = -Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
annotate("text", x = 4, y = -0.5, label="Lower increase in\nabundance than baseline")+
annotate("text", x = 18, y = 0.6, label="Higher increase in\nabundance than baseline")
dev.off()
tikzDevice::tikz("../../results/results_TMB/pcawg/reports_per_cancer_type/cors_trinucleotide3sorted_v3.tex", height = 4, width = 5.5)
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
# geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
# geom_segment(aes(x = 19, y = 0, xend = 18, yend = -Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
annotate("text", x = 5, y = -0.5, label="Lower increase in\nabundance than baseline")+
annotate("text", x = 18, y = 0.6, label="Higher increase in\nabundance than baseline")
dev.off()
tikzDevice::tikz("../../results/results_TMB/pcawg/reports_per_cancer_type/cors_trinucleotide3sorted_v3.tex", height = 4, width = 5.5)
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
# geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
# geom_segment(aes(x = 19, y = 0, xend = 18, yend = -Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
annotate("text", x = 5, y = -0.55, label="Lower increase in\nabundance than baseline")+
annotate("text", x = 18, y = 0.6, label="Higher increase in\nabundance than baseline")
dev.off()
tikzDevice::tikz("../../results/results_TMB/pcawg/reports_per_cancer_type/cors_trinucleotide3sorted_v3.tex", height = 4, width = 5.5)
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
# geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
# geom_segment(aes(x = 19, y = 0, xend = 18, yend = -Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
annotate("text", x = 5, y = -0.55, label="Lower increase in\nabundance than baseline")+
annotate("text", x = 18, y = 0.6, label="Higher increase in\nabundance than baseline")+
ylim(c(-0.7, 0.8))
dev.off()
tikzDevice::tikz("../../results/results_TMB/pcawg/reports_per_cancer_type/cors_trinucleotide3sorted_v3.tex", height = 4, width = 5.5)
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
# geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
# geom_segment(aes(x = 19, y = 0, xend = 18, yend = -Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
annotate("text", x = 5, y = -0.6, label="Lower increase in\nabundance than baseline")+
annotate("text", x = 18, y = 0.65, label="Higher increase in\nabundance than baseline")+
ylim(c(-0.7, 0.8))
dev.off()
tikzDevice::tikz("../../results/results_TMB/pcawg/reports_per_cancer_type/cors_trinucleotide3sorted_v3.tex", height = 4, width = 5.5)
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
# geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
# geom_segment(aes(x = 19, y = 0, xend = 18, yend = -Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
annotate("text", x = 5, y = -0.6, label="More clonal than baseline")+
annotate("text", x = 18, y = 0.65, label="More subclonal than baseline")+
ylim(c(-0.7, 0.8))
dev.off()
# tikzDevice::tikz("../../results/results_TMB/pcawg/reports_per_cancer_type/cors_trinucleotide3sorted_v3.tex", height = 4, width = 5)
tikzDevice::tikz("../../results/results_TMB/pcawg/reports_per_cancer_type/cors_trinucleotide3sorted_v3.tex", height = 4, width = 5.5)
ggplot(melt(as(betas_nucleotides_slopes, 'matrix')),
aes(x=factor(Var2,levels=names(sort(colMeans(betas_nucleotides_slopes)))),
col=Var1, shape=Var1, y=value))+geom_point()+
geom_hline(yintercept = 0, lty='dashed')+theme_bw()+geom_line(aes(group=Var1))+
theme_bw()+theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
theme(axis.title.x = element_blank(),
legend.position = "bottom",
# legend.position = c(.5,-.5),
# plot.margin = unit(c(0,0,4,0), 'lines'),
legend.title = element_blank())+
# labs(y=("$\\widehat{\\betab}_1$"))+
labs(y=("$\\hat{\\beta}_1$"))+
guides(col=guide_legend(nrow=1,byrow=TRUE))+
scale_color_manual(values = nucleotide_colours_logR)+
# geom_segment(aes(x = 5, y = 0, xend = 5, yend = Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
# geom_segment(aes(x = 19, y = 0, xend = 18, yend = -Inf),
#              arrow = arrow(length = unit(0.2, "cm")), col='black')+
annotate("text", x = 5.5, y = -0.6, label="More clonal than baseline")+
annotate("text", x = 18, y = 0.65, label="More subclonal than baseline")+
ylim(c(-0.7, 0.8))
dev.off()
